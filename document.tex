% Use the ijcai22 format

%%%% ijcai22.tex

\typeout{IJCAI--22 Instructions for Authors}

% These are the instructions for authors for IJCAI-22.

\documentclass{article}
\pdfpagewidth=8.5in
\pdfpageheight=11in
% The file ijcai22.sty is NOT the same as previous years'
\usepackage{ijcai22}

% Use the postscript times font!
\usepackage{times}
\usepackage{soul}
\usepackage{url}
\usepackage[hidelinks]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[small]{caption}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{tkz-graph}

\urlstyle{same}

% the following package is optional:
%\usepackage{latexsym}

% See https://www.overleaf.com/learn/latex/theorems_and_proofs
% for a nice explanation of how to define new theorems, but keep
% in mind that the amsthm package is already included in this
% template and that you must *not* alter the styling.
\newtheorem{example}{Example}
\newtheorem{theorem}{Theorem}

\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}

% Following comment is from ijcai97-submit.tex:
% The preparation of these files was supported by Schlumberger Palo Alto
% Research, AT\&T Bell Laboratories, and Morgan Kaufmann Publishers.
% Shirley Jowell, of Morgan Kaufmann Publishers, and Peter F.
% Patel-Schneider, of AT\&T Bell Laboratories collaborated on their
% preparation.

% These instructions can be modified and used in other conferences as long
% as credit to the authors and supporting agencies is retained, this notice
% is not changed, and further modification or reuse is not restricted.
% Neither Shirley Jowell nor Peter F. Patel-Schneider can be listed as
% contacts for providing assistance without their prior permission.

% To use for other conferences, change references to files and the
% conference appropriate and use other authors, contacts, publishers, and
% organizations.
% Also change the deadline and address for returning papers and the length and
% page charge instructions.
% Put where the files are available in the appropriate places.

% PDF Info Is REQUIRED.
% Please **do not** include Title and Author information
\pdfinfo{
	/TemplateVersion (IJCAI.2022.0)
}

\title{Bayesian Networks and Graph Rewrites}

% Single author syntax
\author{
	Adam Chen
	\affiliations
	Stevens Institute of Technology
	\emails
	achen19@stevens.edu
}

\newcommand{\problemone}{Directionality Problem}
\newcommand{\problemtwo}{Marginalized Variables Problem}


\begin{document}
	
	\maketitle
	
	\begin{abstract}
		It is known that Bayesian networks are an insufficient model for causality, as they merely describe the decomposition of a joint probability into conditional probabilities.
		This fails, in most cases, to capture directionality --- a crucial aspect of causality.
		Furthermore, conditional probability fails to tell us about hidden confounders.
		
		I look at the mathematical formalizations of these two shortcomings, and review the existing corpus of work on their categorization.
		I implement a tool to analyze when these shortcomings may be an issue and create ambiguities in Bayesian networks.
		The tool is used to find ambiguities in practical, real-life Bayesian networks, and the implications of such ambiguities on causal inference is discussed.
	\end{abstract}
	
		
	\section{Equivalent Bayesian Networks}
	\subsection{Background}
	$A \rightarrow B \rightarrow C$ is indistinguishable from $C \rightarrow B \rightarrow A$. However, substituting one structure with another in all cases may not preserve validity of a Bayesian network.
	
	We may take a structure $A \rightarrow B$ and replace it with creating a new node $C$ with $A \leftarrow C \rightarrow B$.
	
	\paragraph{Equivalency} Two Bayesian Networks are equivalent when \dots
	
	\subsection{Motivating Example}
	
	\begin{figure}[b]
		\begin{tikzpicture}[scale=1]
			\tikzstyle{VertexStyle} = [shape=rectangle,minimum width=6ex, draw]
			\tikzstyle{EdgeStyle}   = [->,>=stealth']
			
			\SetGraphUnit{1.5}
			\Vertex{Smoking}  \SOWE(Smoking){Chronic Bronchitis} \SOEA(Smoking){Lung Cancer}
			\SOEA(Chronic Bronchitis){Fatigue} \SOEA(Lung Cancer){Mass on X-Ray} \NOEA(Lung Cancer){X}
			\Edge[label=?](Smoking)(Chronic Bronchitis) \Edge(Smoking)(Lung Cancer)
			\Edge(Lung Cancer)(Fatigue) \Edge(Lung Cancer)(Mass on X-Ray) \Edge(Chronic Bronchitis)(Fatigue)
			\Edge[style=dotted](X)(Smoking) \Edge[style=dotted](X)(Lung Cancer)
		\end{tikzpicture}
		\caption{Example of a Bayesian network. Are we able to reverse the ``?'' arrow? Are we able to add the X node (and dotted edges)?}
		\label{dir-ex}
	\end{figure}
	
	Consider the Bayesian network shown in Figure \ref{dir-ex}, modified with two proposed changes from one presented in slides by Kleinberg\cite{lec4slides}.
	
	We know that in simple examples, as shown before, we may be able to reverse the direction of an arrow and have an equivalent Bayesian network.
	Is it the case that we can flip the arrow labeled with ``?'' and have an equivalent network? More generally, what are all of ways we can flip arrows and have an equivalent network? I refer to this as the ``\problemone''. 

	We also know that many cases, there is some underlying cause (say X), that causes two other variables, thus creating an apparent correlation (in the example, smoking and lung cancer). In this example, can we add the node X and maintain compatibility with the joint probability distributions (excluding X) described by the original network? More generally, how can we add (or remove) nodes while maintaining compatibility on the restricted domain? I refer to this as the ``\problemtwo''.
	
	\subsection{Goals}
	Implementation of solutions to both problems, use of them to analyze a few existing networks.


	\section{\problemone}
	
	Verma \& Pearl\cite{verma2013equivalence} give a necessary and sufficient condition for testing the equivalence of Bayesian networks.
	Specifically, and phrased more simply by Chickering\cite{chickering2013transformational}, two Bayesian networks are equivalent if they have the same:
	\begin{enumerate}
		\item Skeleton: set of vertices and undirected edges.
		\item V-Structures: set of all unshielded colliders (i.e. triples of the form $X \rightarrow Y \leftarrow Z$ with $X$ not adjacent to $Z$).
	\end{enumerate}
	More generally, since each Bayesian network belongs to a finitely-sized equivalence class of networks completely determined by skeleton and v-structures, we may characterize all networks equivalent to a given network by those factors.
	
	In the case of whether a single edge is reversible (while preserving equivalence), Chickering\cite{chickering2013transformational} presents a necessary and sufficient condition: the edge $X \rightarrow Y$ is reversible if and only if the parents of $Y$ are exactly $X$ and the parents of $X$.
	(Moreover, they show that every equivalent network may be reached by a sequence of such edge reversals.)
	
	\paragraph{Revisiting the Motivating Example}
	
	Recall Figure \ref{dir-ex}. Observe that the sole parent of the Chronic Bronchitis node is the Smoking node, and that the Smoking node has no parents.
	In other words, Chickering's condition is satisfied, so we may conclude that that edge is reversible.
	
	More generally, we may want to know what are \emph{all} the possible assignments of directions to arrows that maintain equivalency.
	To do so, we note that the only v-structure in the graph is Chronic Bronchitis $\rightarrow$ Fatigue $\leftarrow$ Lung Cancer.
	Thus we may erase the arrows on all other edges, and we obtain Figure \ref{undir-ex}.
	
	\begin{figure}[b]
	\begin{tikzpicture}[scale=1]
		\tikzstyle{VertexStyle} = [shape=rectangle,minimum width=6ex, draw]
		\tikzstyle{EdgeStyle}   = [-,>=stealth']
		
		\SetGraphUnit{1.5}
		\Vertex{Smoking}  \SOWE(Smoking){Chronic Bronchitis} \SOEA(Smoking){Lung Cancer}
		\SOEA(Chronic Bronchitis){Fatigue} \SOEA(Lung Cancer){Mass on X-Ray}
		\Edge(Smoking)(Chronic Bronchitis) \Edge(Smoking)(Lung Cancer)
		\draw[thick, ->,>=stealth'](Lung Cancer)--(Fatigue); \Edge(Lung Cancer)(Mass on X-Ray) \draw[thick, ->,>=stealth'](Chronic Bronchitis)--(Fatigue);
	\end{tikzpicture}
	\caption{Replacing every undirected edge with an edge in an arbitrary direction, without introducing any new v-structures, yields an equivalent Bayesian network.}
	\label{undir-ex}
	\end{figure}

	However, we may not assign directions to the undirected edges however we please ($2^3=8$ ways).
	The new assignment of directions must not introduce any new v-structures, and it must not create any cycles.
	These constraints limit the choice of direction to four options:
	\begin{enumerate}
		\item The graph as shown in Figure \ref{dir-ex}.
		\item Chronic Bronchitis $\rightarrow$ Smoking $\rightarrow$ Lung Cancer $\rightarrow$ Mass on X-Ray.
		\item Mass on X-Ray $\rightarrow$ Lung Cancer $\rightarrow$ Smoking $\rightarrow$ Chronic Bronchitis.
		\item Chronic Bronchitis $\leftarrow$ Smoking $\leftarrow$ Lung Cancer $\rightarrow$ Mass on X-Ray.
	\end{enumerate}
	Any other choice on arrows would create a new v-structure, either on (Chronic Bronchitis, Smoking, Lung Cancer), or on (Smoking, Lung Cancer, Mass on X-Ray). In this example, creating a cycle is impossible.
	
	\section{\problemtwo}
	\paragraph{Marginalization}
	
	\paragraph{Node Addition}
	In the case of inference, we may be more interested in whether our observed data is data marginalized on some hidden cause X.
	Formally, is it the case that:
	$$
	\exists X: P(V_0, V_1, \dots, V_k) = \sum_X{P(V_0, V_1, \dots, V_k, X)}
	$$
	
	\section{Evaluation}
	
	\subsection{Implementation}
	
	A program for reading in directed graphs (interpreted as Bayesian networks) and performing analyses on them was written.
	
	\paragraph{Bayesian Network Equivalence}
	As per the characterization of congruence classes of Bayesian networks presented in \cite{verma2013equivalence,chickering2013transformational}, testing for the equivalence of Bayesian networks was implemented via analysis on skeletons and v-structures.
	
	Additionally, a recursive, back-tracking assignment algorithm was implemented for enumerating \emph{all} Bayesian networks equivalent to a given network.
	Indeed, this tool was used to validate the explanation given for the motivating example.
	
	\subsection{Analysis of Other Bayesian Networks}
	
	\section{Discussion}
	
	It is known that Bayesian networks are, on their own, insufficient models of causality.
	Nevertheless, graphical models are useful for causal inference, and graphical models can capture many intuitions about causality (multiple causes, multiple effects, etc.).
	Thus when performing such inference, it is important to know how merely looking at dependence relations between data can lead us astray.
	
	More concretely, causal inference asserts several assumptions on top of pure statistical inference\cite{ramsey2012adjacencyfaithfulness}:
	\begin{itemize}
		\item The causal Markov condition: the set of variables has a causal structure that forms a DAG that satisfies the Bayesian conditional dependence rule.
		\item (Causal) faithfulness, decomposable as:
			\subitem Adjacency faithfulness: adjacent nodes are dependent given any combination of other nodes.
			\subitem Orientation faithfulness: when we have a v-structure (x, y, z), x and z are dependent given any subset of other nodes that contains y.
	\end{itemize}
	However, there are several problems.
	I have already shown that several distinct DAGs can be compatible with the same joint probability distribution.
	It is unclear that we can, a priori, know which DAG represents the proper causal structure.
	Indeed, Verma \& Pearl note that the recovery of a causal network from data is only up to modulo DAG equivalence\cite{verma2013equivalence}.
	It is also clear that the causal Markov condition (as presented) entails a form of completeness, e.g. common causes, which may appear as marginalized variables in a probabilistic network, are explicit.
	Once again, there appears to be no a priori way to know if all common causes are accounted for. I propose several suggestions to mitigate these problems, based on the findings in previous sections.
	
	\subsection{Measure Common Effects}
	The special importance of v-structures to the directness of a Bayesian network suggests that when designing a study, we should prioritize measuring variables that we believe will take this structure.
	Thus, the structure around these variables will be determined by the probability and so will not have an ambiguous direction.
	Namely, we would like to identify cases where there is a common effect (collider) of two independent causes (unshielded).
	
	\subsection{The Importance of Ground Truth}
	
	\bibliographystyle{plain}
	\bibliography{references}
	
	\appendix
	
\end{document}
